<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="680" xmlns="http://www.w3.org/2000/svg">
  <!-- 白色背景 -->
  <rect width="100%" height="100%" fill="#ffffff"/>
  
  <defs>
    <style>
      .layer-box { stroke-width: 3; rx: 12; ry: 12; fill: none; }
      .app-layer { stroke: #1976d2; fill: #e3f2fd; }
      .client-layer { stroke: #7b1fa2; fill: #f3e5f5; }
      .component-layer { stroke: #388e3c; fill: #e8f5e8; }
      .core-layer { stroke: #f57c00; fill: #fff3e0; }
      .box { fill: #ffffff; stroke: #424242; stroke-width: 2; rx: 8; ry: 8; }
      .text { text-anchor: middle; font-family: Arial, sans-serif; }
      .layer-title { font-size: 16px; font-weight: bold; fill: #333; }
      .component-title { font-size: 12px; font-weight: bold; fill: #333; }
      .component-desc { font-size: 10px; fill: #666; }
      .generic-text { font-size: 10px; fill: #1976d2; font-style: italic; }
      .arrow { stroke: #424242; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#424242"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="25" class="layer-title text">ClientSocket 架構圖</text>
  <text x="400" y="45" class="component-desc text">四層架構設計 - Application → Framework → Component → Core</text>

  <!-- Application Layer -->
  <rect x="50" y="80" width="700" height="100" class="layer-box app-layer"/>
  <text x="400" y="75" class="layer-title text">Application Layer</text>
  
  <rect x="100" y="110" width="130" height="50" class="box"/>
  <text x="165" y="130" class="component-title text">DemoByteClient</text>
  <text x="165" y="145" class="component-desc text">範例客戶端</text>
  
  <rect x="270" y="110" width="130" height="50" class="box"/>
  <text x="335" y="130" class="component-title text">ChatClient</text>
  <text x="335" y="145" class="component-desc text">聊天客戶端</text>
  
  <rect x="440" y="110" width="130" height="50" class="box"/>
  <text x="505" y="130" class="component-title text">ProtocolHandler</text>
  <text x="505" y="145" class="component-desc text">協議處理器</text>
  
  <rect x="600" y="110" width="120" height="50" class="box"/>
  <text x="660" y="130" class="component-title text">Business Logic</text>
  <text x="660" y="145" class="component-desc text">業務邏輯</text>

  <!-- Client Framework Layer -->
  <rect x="50" y="220" width="700" height="180" class="layer-box client-layer"/>
  <text x="400" y="215" class="layer-title text">ClientSocket Framework</text>
  
  <rect x="100" y="250" width="130" height="70" class="box"/>
  <text x="165" y="270" class="component-title text">ByteSocket</text>
  <text x="165" y="285" class="generic-text text">&lt;H&gt;</text>
  <text x="165" y="298" class="component-desc text">自動重連</text>
  <text x="165" y="311" class="component-desc text">H extends HeaderBase</text>
  
  <rect x="270" y="250" width="130" height="70" class="box"/>
  <text x="335" y="270" class="component-title text">JsonSocket</text>
  <text x="335" y="285" class="generic-text text">&lt;H&gt;</text>
  <text x="335" y="298" class="component-desc text">JSON 序列化</text>
  <text x="335" y="311" class="component-desc text">H extends HeaderBase</text>
  
  <rect x="440" y="250" width="130" height="70" class="box"/>
  <text x="505" y="270" class="component-title text">IClient</text>
  <text x="505" y="285" class="generic-text text">&lt;H, M, B&gt;</text>
  <text x="505" y="298" class="component-desc text">客戶端接口</text>
  <text x="505" y="311" class="component-desc text">H extends HeaderBase</text>
  
  <rect x="600" y="250" width="120" height="70" class="box"/>
  <text x="660" y="270" class="component-title text">Connector</text>
  <text x="660" y="285" class="component-desc text">連接管理器</text>
  <text x="660" y="298" class="component-desc text">重連邏輯</text>
  <text x="660" y="311" class="component-desc text">心跳保持</text>
  
  <rect x="200" y="335" width="300" height="50" class="box"/>
  <text x="350" y="350" class="component-title text">SocketBase&lt;H, M, B&gt;</text>
  <text x="350" y="365" class="component-desc text">通用 Socket 基類 (H extends HeaderBase)</text>

  <!-- Component Layer -->
  <rect x="30" y="425" width="740" height="100" class="layer-box component-layer"/>
  <text x="400" y="420" class="layer-title text">Component Layer</text>
  
  <rect x="80" y="455" width="120" height="50" class="box"/>
  <text x="140" y="475" class="component-title text">AutoReconnect</text>
  <text x="140" y="490" class="component-desc text">自動重連機制</text>
  
  <rect x="230" y="455" width="120" height="50" class="box"/>
  <text x="290" y="475" class="component-title text">Ping</text>
  <text x="290" y="490" class="component-desc text">心跳檢測</text>
  
  <rect x="380" y="455" width="120" height="50" class="box"/>
  <text x="440" y="475" class="component-title text">ConnectionPool</text>
  <text x="440" y="490" class="component-desc text">連接池管理</text>
  
  <rect x="530" y="455" width="120" height="50" class="box"/>
  <text x="590" y="475" class="component-title text">Netty Client</text>
  <text x="590" y="490" class="component-desc text">底層網路層</text>

  <!-- Core Layer -->
  <rect x="20" y="565" width="760" height="80" class="layer-box core-layer"/>
  <text x="400" y="560" class="layer-title text">SocketIO Core</text>
  
  <rect x="60" y="585" width="100" height="40" class="box"/>
  <text x="110" y="600" class="component-title text">HeaderBase</text>
  <text x="110" y="612" class="component-desc text">協議頭基類</text>
  
  <rect x="190" y="585" width="100" height="40" class="box"/>
  <text x="240" y="600" class="component-title text">IConnection</text>
  <text x="240" y="612" class="component-desc text">連接接口</text>
  
  <rect x="320" y="585" width="100" height="40" class="box"/>
  <text x="370" y="600" class="component-title text">ByteArrayBuffer</text>
  <text x="370" y="612" class="component-desc text">緩衝區</text>
  
  <rect x="450" y="585" width="100" height="40" class="box"/>
  <text x="500" y="600" class="component-title text">MessageBase</text>
  <text x="500" y="612" class="component-desc text">消息基類</text>
  
  <rect x="580" y="585" width="100" height="40" class="box"/>
  <text x="630" y="600" class="component-title text">Utilities</text>
  <text x="630" y="612" class="component-desc text">工具類</text>

  <!-- Arrows -->
  <path class="arrow" d="M 250 180 L 250 220"/>
  <path class="arrow" d="M 250 385 L 250 425"/>
  <path class="arrow" d="M 250 525 L 250 565"/>
</svg>
